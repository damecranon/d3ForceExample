<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>D3 Force Layout</title>
    <link rel="stylesheet" href="css/index.css" />
</head>
<body>



 <script src="https://d3js.org/d3.v4.min.js"></script>
<script src="js/d3.js"></script>
<script type="text/javascript">
    /* start out the d3 layout */
    var width = 1100;
    var height = 800;

    var nodes = [
        {"name": "Lillian", "sex": "F"},
        {"name": "Gordon", "sex": "M"},
        {"name": "Sylvester", "sex": "M"},
        {"name": "Mary", "sex": "F"},
        {"name": "Helen", "sex": "F"},
        {"name": "Jamie", "sex": "M"},
        {"name": "Jessie", "sex": "F"},
        {"name": "Ashton", "sex": "M"},
        {"name": "Duncan", "sex": "M"},
        {"name": "Evette", "sex": "F"},
        {"name": "Mauer", "sex": "M"},
        {"name": "Fray", "sex": "F"},
        {"name": "Duke", "sex": "M"},
        {"name": "Baron", "sex": "M"},
        {"name": "Infante", "sex": "M"},
        {"name": "Percy", "sex": "M"},
        {"name": "Cynthia", "sex": "F"}

    ];

    var svg = d3.select('body').append('svg').attr('width', width).attr('height', height);

    var parentg = svg.append('g').attr('class', 'parentg').selectAll('g');
    var childg = parentg.data(nodes).enter().append('g');


    //the simulation(force layout)
    var collideMethod = d3.forceCollide( function(d){return d.r + 8 }).iterations(16);

    //first we will set up the simulation
    var simulation = d3.forceSimulation()
        .force("link", d3.forceLink().id(function(d){return d.id;}))
        .force("charge", d3.forceManyBody())
        .force("center", d3.forceCenter(width / 2, height /2))
        .force("collide", collideMethod);

   //var node = childg.append('g').append('circle').attr('r', 10).attr('fill', circlecolor);

    //the parent g tag

function update() {
     node = svg.append('svg:g')
        .attr("class", "nodes")
        .selectAll("g")
        .data(nodes)
        .enter()
        .append("circle")
        .attr("r", 10)
        .attr("fill", circlecolor);
}

simulation.on("tick", ticked).nodes(nodes);

function ticked(){
        //update circle positions each tick of simulation

    node.attr("cx", function(d){return d.x}).attr("cy", function(d){return d.y});
    childg.attr('transform', function(d){return 'translate(' + d.x + ',' + d.y + ')'; });
}


    function circlecolor(d){
        if (d.sex == "M"){
            return "blue";
        } else {
            return "pink";
        }
    }
svg.on("click", function (event) {

    alert("click works");
     var mDown = d3.mouse(svg.node());
    console.log("Mouse Position: " +mDown);
});

update();
</script>
</body>
</html>